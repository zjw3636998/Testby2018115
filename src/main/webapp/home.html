<!DOCTYPE html>
<html lang="en">
    <head>
		<meta charset="UTF-8">
		<title>匠真后台管理系统</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<link rel="stylesheet" type="text/css" href="themes/css/reset.css">
		<link rel="stylesheet" type="text/css" href="themes/plugs/bootstrap/css/bootstrap.css">
	    <link rel="stylesheet" type="text/css" href="themes/plugs/layui/layui/css/layui.css">
		<link rel="stylesheet" type="text/css" href="themes/css/weadmin.css">
		<script type="text/javascript" src="themes/plugs/jquery/jquery.min.js"></script>
	    <script type="text/javascript" src="themes/plugs/layui/layui/layui.js"></script>
	</head>
    <body>
		<div class="homeWrap">
			<div class="head-tabs">
				<div class="crumb">
					<span class="layui-breadcrumb"  style="visibility:visible;">
						<a href="">我的桌面</a>
						<span lay-separator>》</span>
						<a href=""><cite>首页</cite></a>
					</span>
				</div>
				<ul class="head-tips">
					<li class="todo-list">
						<span>待办事项</span>
						<span class="i-badge" id="todoList">1</span>
					</li>
					<li id="changeC">
						<span>待审核</span>
						<span class="i-badge" id="Review">12</span>
					</li>
				</ul>	
			</div>
			<div class="main-con">
				<div class="main-data">
					<ul class="wrap-con">
						<li class="con-item">
							<div class="info-items">
								<span class="info-tit">一元咨询公众号点击量</span>
								<span class="info-date">（2018.01.24 -- 今日）</span>
								<span class="info-num" id="gzh_Num">5555</span>
							</div>
							<div class="data-img">
								<img src="../themes/images/data-icon.png" alt="" class="img-icom">
							</div>
						</li>
						<li class="con-item">
							<div class="info-items">
								<span class="info-tit">百年计划小程序点击量</span>
								<span class="info-date">（2018.01.24 -- 今日）</span>
								<span class="info-num" id="Plan_Num">0</span>
							</div>
							<div class="data-img">
								<img src="../themes/images/data-icon.png" alt="" class="img-icom">
							</div>
						</li>
						<li class="con-item">
							<div class="info-items">
								<span class="info-tit">成交订单量</span>
								<span class="info-date">（2018.01.24 -- 今日）</span>
								<span class="info-num" id="order_Num">0</span>
							</div>
							<div class="data-img">
								<img src="../themes/images/data-icon.png" alt="" class="img-icom">
							</div>
						</li>
						<li class="con-item">
							<div class="info-items">
								<span class="info-tit">成交金额</span>
								<span class="info-date">（2018.01.24 -- 今日）</span>
								<span class="info-num">￥<i id="trade_num">1222.00</i></span>
							</div>
							<div class="data-img">
								<img src="../themes/images/data-icon.png" alt="" class="img-icom">
							</div>
						</li>
					</ul>
				</div>
				<div class="table-enchart">
					<div id="gzhNum" style="width: 100%;height:380px;" class="tabone"></div>
					<div class="encharts-item">
						<div id="zxNum" style="width: 53.5%;height:280px;" class="tabtwo"></div>
						<div id="planNum" style="width: 45%;height:280px;" class="tabthree"></div>
					</div>
				</div>
			</div>
		</div>
		<script src="themes/plugs/encharts/echarts.js"></script>
		<script src="themes/plugs/encharts/customed.js"></script>
		
		<script>
			var myChartone = echarts.init(document.getElementById('gzhNum'));
			var myCharttwo = echarts.init(document.getElementById('zxNum'));
			var myChartthree = echarts.init(document.getElementById('planNum'));
			/*var colors = ['#0e72ef'];*/
			var option1 = {
			/*color: colors;*/
			color:['#b0d3ff'],
            title: {
			        text: '公众号访问量图'
			    },
			    tooltip : {
			        trigger: 'none',
			        axisPointer: {
			            type: 'cross',
			            label: {
			                backgroundColor: '#6a7985'
			            }
			        }
			    },
			    legend: {
			        data:['公众号访问总量']
			    },
			    toolbox: {
			        feature: {
			            saveAsImage: {}
			        }
			    },
			    grid: {
			        left: '3%',
			        right: '4%',
			        bottom: '3%',
			        containLabel: true
			    },
			    xAxis : [
			        {
			            type : 'category',
			             axisTick: {
			                alignWithLabel: true
			            },
			            boundaryGap : false,
			            data : ['2018/5','2018/6','2018/7','2018/8','2018/9','2018/10','2018/11','2018/12']
			        }
			    ],
			    yAxis : [
			        {
			            type : 'value'
			        }
			    ],
			    series : [
			        {
			            name:'公众号访问总量',
			            type:'line',
			            stack: '总量',
			            areaStyle: {},
			            data:[120, 132, 101, 134, 90, 230, 210,200]
			        }
			       
			            
			        
			    ]
        	};
        var option2 = {
        	color:['#fe798e','#0e72ef'],
            title: {
                text: '折线图'
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data:['一元咨询用户点击量','微云咨询用户点击量']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: ['五月','六月','七月','八月','九月','十月','十一月','十二月']
            },
            yAxis: {
                type: 'value'
            },
            series: [
                {
                    name:'一元咨询用户点击量',
                    type:'line',
                    stack: '总量',
                    data:[60, 80, 59, 70, 87, 45, 75,65]
                },
                {
                    name:'微云咨询用户点击量',
                    type:'line',
                    stack: '总量',
                    data:[30, 60, 40, 20, 66, 42, 57,76]
                },
            ]
        };
        option3 = {
        	color:['#00b7fd','#ffb400','#0e72ef','#fb633c'],
		    title : {
		        text: '百年计划访问量',
		        x:'center'
		    },
		    tooltip : {
		        trigger: 'item',
		        formatter: "{a} <br/>{b} : {c} ({d}%)"
		    },
		    legend: {
		        orient: 'vertical',
		        left: 'left',
		        data: []
		    },
		    series : [
		        {
		            name: '访问量',
		            type: 'pie',
		            radius : '55%',
		            center: ['50%', '60%'],
		            data:[],
		            itemStyle: {
		                emphasis: {
		                    shadowBlur: 10,
		                    shadowOffsetX: 0,
		                    shadowColor: 'rgba(0, 0, 0, 0.5)'
		                }
		            }
		        }
		    ]
		};
         myChartone.setOption(option1);
         myCharttwo.setOption(option2);
         myChartthree.setOption(option3);




         /*页面数据加载*/
         function addLoadEvent(fun){
		    var oldLoad = window.onload;
		    if(typeof  oldLoad != "function"){
		        window.onload = fun;
		    }else{
		        window.onload = function(){
		            oldLoad();
		            fun();
		        }
		    }
		}
		var g_num = document.getElementById("gzh_Num");
		var p_num = document.getElementById("Plan_Num");
		var o_num = document.getElementById("order_Num");
		var t_num = document.getElementById("trade_num");
		var todo_list = document.getElementById("todoList");
		var Review = document.getElementById("Review");
		var changeC = document.getElementById("changeC");
		
		function getHttpObject(){
		    if(window.XMLHttpRequest){
		        var xhr = new XMLHttpRequest();
		    }else{
		        var xhr = new ActiveXObject("Microsoft.XMLHTTP");
		    }
		    xhr.open("POST","selVisited.do");
		    xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
		    xhr.send();
		    xhr.onreadystatechange=function(){
                if(xhr.readyState==4 && xhr.status==200){
      
                    var data = xhr.responseText;
                    data=JSON.parse(data);
                    //json字符串转换成为json对象  , data=eval("("+data+")");evel不存在兼容性问题，但是会有安全漏洞。
                    if(data.success == 200){
                    	/* 待办事项 */
                    	 todo_list.innerHTML = data.orderDeal;
                    	/* 待审核 */
                    	Review.innerHTML = data.review ;
                    	/* 公众号点击量 */
                    	g_num.innerHTML = data.visitedCount[0].t_count;
                    	/* 百年计划访问量 */
                    	p_num.innerHTML = data.visitedCount[1].t_count;
                    	/* 成交订单量 */
                    	o_num.innerHTML = data.orderCount; 
                    	/* 成交金额 */
                    	t_num.innerHTML = data.orderPayCount;
                    	/* 判断待审核的style */
                    	if(data.getPermission == 1){
                    		 changeC.className="todo-list";
                    		 
                    	}else{
                    		changeC.className="review";
                    	} 
                    	var nums = [];
                    	var plannames = [];
            			
                    	/* for(var i=0;i<4;i++){
                              nums.push(data.xcxCount[i].access_time);    //挨个取出销量并填入销量数组
                           }*/
                           var result = data.xcxCount;
                           $.each(result,function(key,values){ //此处我返回的是list<String,map<String,String>>循环map
                        	   plannames.push(values.access_name);
                               var obj = new Object();
                               obj.value = values.access_time;
                               obj.name = values.access_name;
                               nums.push(obj);
                            });
                      
                         myChartthree.hideLoading();
                    	 myChartthree.setOption({
                    		 legend: {
                                 data: plannames
                                },
                    		 series: {
                    			 data: nums
                    			 }   
    					}); 
                    	
                    	
                    }
                    
                   
                    
    				
                };
            };
		}
		addLoadEvent(getHttpObject);

		</script>
    </body>
</html>